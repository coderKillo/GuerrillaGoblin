[gd_resource type="BehaviorTree" load_steps=44 format=3 uid="uid://b3a7my7biibgj"]

[ext_resource type="Script" path="res://game/enemy/ai/tasks/see_target.gd" id="1_upjog"]
[ext_resource type="Script" path="res://game/enemy/ai/tasks/set_target_position.gd" id="2_et8a4"]
[ext_resource type="Script" path="res://game/enemy/ai/tasks/is_close_to_position.gd" id="3_2ibbs"]
[ext_resource type="Script" path="res://game/enemy/ai/tasks/notify_target.gd" id="4_2dmdv"]
[ext_resource type="Script" path="res://game/enemy/ai/tasks/move_to_position.gd" id="4_wthjh"]
[ext_resource type="Script" path="res://game/enemy/ai/tasks/next_path_point.gd" id="5_fdm25"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_u6w21"]
var/target_position/name = &"target_position"
var/target_position/type = 5
var/target_position/value = Vector2(0, 0)
var/target_position/hint = 0
var/target_position/hint_string = ""
var/path_position/name = &"path_position"
var/path_position/type = 5
var/path_position/value = Vector2(0, 0)
var/path_position/hint = 0
var/path_position/hint_string = ""
var/has_seen_target/name = &"has_seen_target"
var/has_seen_target/type = 1
var/has_seen_target/value = false
var/has_seen_target/hint = 0
var/has_seen_target/hint_string = ""

[sub_resource type="BBVariant" id="BBVariant_qe3q2"]
type = 5
saved_value = Vector2(0, 0)
resource_name = "<null>"

[sub_resource type="BTCheckVar" id="BTCheckVar_ts150"]
variable = &"path_position"
value = SubResource("BBVariant_qe3q2")

[sub_resource type="BTAction" id="BTAction_wyw3v"]
custom_name = "SetPositionToGuard"
script = ExtResource("5_fdm25")
position = &"path_position"

[sub_resource type="BTAction" id="BTAction_77xuc"]
custom_name = "SetTargetDirection"
script = ExtResource("5_fdm25")
position = &"target_position"

[sub_resource type="BTSequence" id="BTSequence_7jhel"]
custom_name = "SetGuardPosition"
children = [SubResource("BTCheckVar_ts150"), SubResource("BTAction_wyw3v"), SubResource("BTAction_77xuc")]

[sub_resource type="BTCondition" id="BTCondition_8dkl5"]
script = ExtResource("1_upjog")
target_group = &"player"

[sub_resource type="BBVariant" id="BBVariant_ntxes"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTCheckVar" id="BTCheckVar_wwfut"]
variable = &"has_seen_target"
value = SubResource("BBVariant_ntxes")

[sub_resource type="BBVariant" id="BBVariant_0etm7"]
type = 4
saved_value = "?"
resource_name = "?"

[sub_resource type="BTSetAgentProperty" id="BTSetAgentProperty_fdoc1"]
property = &"status"
value = SubResource("BBVariant_0etm7")

[sub_resource type="BBVariant" id="BBVariant_j4vf8"]
type = 3
saved_value = 0.0
resource_name = "0"

[sub_resource type="BTSetAgentProperty" id="BTSetAgentProperty_r1d8n"]
property = &"movement_speed"
value = SubResource("BBVariant_j4vf8")
custom_name = "stop moving"

[sub_resource type="BBVariant" id="BBVariant_wc250"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTSetVar" id="BTSetVar_svjsu"]
variable = &"has_seen_target"
value = SubResource("BBVariant_wc250")

[sub_resource type="BTDelay" id="BTDelay_jovrf"]
children = [SubResource("BTSetVar_svjsu")]

[sub_resource type="BTSequence" id="BTSequence_uvyls"]
custom_name = "LookSequence"
children = [SubResource("BTCondition_8dkl5"), SubResource("BTCheckVar_wwfut"), SubResource("BTSetAgentProperty_fdoc1"), SubResource("BTSetAgentProperty_r1d8n"), SubResource("BTDelay_jovrf")]

[sub_resource type="BTCondition" id="BTCondition_vv15l"]
script = ExtResource("1_upjog")
target_group = &"player"

[sub_resource type="BTAction" id="BTAction_gj5e8"]
script = ExtResource("2_et8a4")
position = &"target_position"

[sub_resource type="BTAction" id="BTAction_4gi87"]
script = ExtResource("4_2dmdv")
mode = 0
message = ""
message_var = &"target_position"
radius = 300.0

[sub_resource type="BBVariant" id="BBVariant_716t8"]
type = 4
saved_value = "!"
resource_name = "!"

[sub_resource type="BTSetAgentProperty" id="BTSetAgentProperty_2cxpn"]
property = &"status"
value = SubResource("BBVariant_716t8")

[sub_resource type="BBVariant" id="BBVariant_cu86x"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTSetAgentProperty" id="BTSetAgentProperty_dxw2u"]
property = &"attack"
value = SubResource("BBVariant_cu86x")
custom_name = "SetAttack"

[sub_resource type="BTSequence" id="BTSequence_oprbq"]
custom_name = "AttackSequence"
children = [SubResource("BTCondition_vv15l"), SubResource("BTAction_gj5e8"), SubResource("BTAction_4gi87"), SubResource("BTSetAgentProperty_2cxpn"), SubResource("BTSetAgentProperty_dxw2u")]

[sub_resource type="BTCondition" id="BTCondition_3rlya"]
script = ExtResource("3_2ibbs")
position = &"path_position"
tolerance = 10.0

[sub_resource type="BTAction" id="BTAction_xrvde"]
script = ExtResource("4_wthjh")
position = &"path_position"
speed = 0.5

[sub_resource type="BTSelector" id="BTSelector_kqr7a"]
custom_name = "Move To Path Position"
children = [SubResource("BTCondition_3rlya"), SubResource("BTAction_xrvde")]

[sub_resource type="BBVariant" id="BBVariant_jai51"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTCheckVar" id="BTCheckVar_op71x"]
variable = &"has_seen_target"
value = SubResource("BBVariant_jai51")

[sub_resource type="BBVariant" id="BBVariant_5qy3g"]
type = 4
saved_value = "?"
resource_name = "?"

[sub_resource type="BTSetAgentProperty" id="BTSetAgentProperty_fva2c"]
property = &"status"
value = SubResource("BBVariant_5qy3g")

[sub_resource type="BTSelector" id="BTSelector_y16w4"]
custom_name = "If has seen target set status"
children = [SubResource("BTCheckVar_op71x"), SubResource("BTSetAgentProperty_fva2c")]

[sub_resource type="BTAction" id="BTAction_oguok"]
custom_name = "LookAt"
script = ExtResource("4_wthjh")
position = &"target_position"
speed = 0.0

[sub_resource type="BTSequence" id="BTSequence_hykpo"]
custom_name = "GuardSequence"
children = [SubResource("BTSelector_kqr7a"), SubResource("BTSelector_y16w4"), SubResource("BTAction_oguok")]

[sub_resource type="BTSelector" id="BTSelector_8xgfp"]
children = [SubResource("BTSequence_7jhel"), SubResource("BTSequence_uvyls"), SubResource("BTSequence_oprbq"), SubResource("BTSequence_hykpo")]

[sub_resource type="BTSequence" id="BTSequence_h5to1"]
custom_name = "Enemy Range Sequence"
children = [SubResource("BTSelector_8xgfp")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_u6w21")
root_task = SubResource("BTSequence_h5to1")
